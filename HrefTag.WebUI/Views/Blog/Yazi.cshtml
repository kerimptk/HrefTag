@using HrefTag.WebUI.ViewModels
@model YaziViewModel
@{
    ViewData["Title"] = "Yazi";
}

<div class="main_content">
    <div class="mcontainer">

        <div class="lg:flex lg:space-x-10">

            <div class="lg:w-3/4 space-y-5">

                <div class="card p-4">
                    <div class="h-44 mb-4 md:h-72 overflow-hidden relative rounded-lg w-full">
                        <img src="~/uploads/@Model.Yazi.OneCikanGorsel" alt="@Model.Yazi.Baslik" class="w-full h-full absolute inset-0 object-cover">
                    </div>

                    <h1 class="lg:text-3xl text-2xl font-semibold mb-6"> @Model.Yazi.Baslik </h1>

                    <div class="space-y-3">
                        @Html.Raw(Model.Yazi.Icerik)
                    </div>

                    <div class="flex items-center space-x-3 my-3 p-4 border-t">
                        <img src="~/uploads/@Model.Yazi.CreateUserAvatar" alt="@Model.Yazi.CreateUserFullName" class="w-10 rounded-full">
                        <div>
                            <div class="text-base font-semibold"> @Model.Yazi.CreateUserFullName </div>
                            <div class="text-xs">Bu içerik @Model.Yazi.OkunmaSayisi kez okundu.</div>
                        </div>
                    </div>
                </div>

                <!-- related articles -->
                <div class="card p-6 relative">
                    <h1 class="block text-lg font-semibold"> İlginizi Çekebilecek Benzer İçerikler</h1>
                    <div class="relative" uk-slider="finite: true">
                        <div class="uk-slider-container px-1 py-3">
                            <ul class="uk-slider-items uk-child-width-1-3@s uk-child-width-1-2 uk-grid-small uk-grid">
                                @foreach (var item in Model.kategoriYaziListDtos.Take(6))
                                {
                                    <li>
                                        <div>
                                            <a asp-controller="Blog" asp-action="yazi" asp-route-Post="@item.UrlBaslik"
                                               class="w-full md:h-32 h-28 overflow-hidden rounded-lg relative block">
                                                <img src="~/uploads/@item.OneCikanGorsel" alt="@item.Baslik"
                                                     class="w-full h-full absolute inset-0 object-cover">
                                            </a>
                                            <div class="pt-3">
                                                <a asp-controller="Blog" asp-action="yazi" asp-route-Post="@item.UrlBaslik"
                                                   class="font-semibold line-clamp-2">@item.Baslik</a>
                                            </div>
                                        </div>
                                    </li>
                                }
                            </ul>
                            <a class="absolute bg-white top-16 flex items-center justify-center p-2 -left-4 rounded-full shadow-md text-xl w-9 z-10 dark:bg-gray-800 dark:text-white" href="#" uk-slider-item="previous">  <ion-icon name="chevron-back-outline"></ion-icon></ion-icon> </a>
                            <a class="absolute bg-white top-16 flex items-center justify-center p-2 -right-4 rounded-full shadow-md text-xl w-9 z-10 dark:bg-gray-800 dark:text-white" href="#" uk-slider-item="next"> <ion-icon name="chevron-forward-outline"></ion-icon></a>
                        </div>
                    </div>
                </div>


                <h3 class="mb-8 mt-20 font-semibold text-2xl"> Yorumlar</h3>
                @if (Model.Yorumlar.Count == 0)
                {
                    <span>
                        Bu içerik için henüz yorum yapılmamış.
                        İlk yorumu yapan sen ol...
                    </span>
                }
                else
                {
                    @foreach (var item in Model.Yorumlar.Where(x => x.YaziId == Model.Yazi.Id && x.OnayDurumuId == 1).ToList())
                    {
                        <div class="flex gap-x-4 mb-5 relative">
                            <img src="assets/images/avatars/avatar-4.jpg" alt="" class="rounded-full shadow w-12 h-12">
                            <div>
                                <h4 class="text-base m-0"> @item.AdSoyad</h4>
                                <span class="text-gray-700 text-sm"> @item.Meslek </span>
                                <p class="mt-3">
                                    @item.KullaniciYorumu
                                </p>
                            </div>
                        </div>
                    }
                }


                <div class="lg:mt-9 mt-5">
                    <!-- Add comment -->
                    <h3 class="mb-8 mt-20 font-semibold text-xl"> Yorum Yap </h3>
                    <form asp-controller="Blog" asp-action="yorumYap" method="post">
                        <input type="text" name="YaziId" hidden value="@Model.Yazi.Id" class="form-control">
                        <div class="flex space-x-4 mb-5 relative">
                            <img src="assets/images/avatars/avatar-4.jpg" alt="" class="rounded-full shadow w-12 h-12">
                            <div class="flex-1">
                                <div class="grid md:grid-cols-4 gap-4">
                                    <div>
                                        <input type="text" name="AdSoyad" placeholder="Ad Soyad" class="bg-gradient-to-b from-gray-100 to-gray-100">
                                    </div>
                                    <div>
                                        <input type="email" name="Email" placeholder="Email" class="bg-gradient-to-b from-gray-100 to-gray-100">
                                    </div>
                                    <div>
                                        <input type="text" name="Website" placeholder="Website" class="bg-gradient-to-b from-gray-100 to-gray-100">
                                    </div>
                                    <div>
                                        <input type="text" name="Meslek" placeholder="Meslek Bilgisi" class="bg-gradient-to-b from-gray-100 to-gray-100">
                                    </div>
                                    <div class="col-span-4">
                                        <textarea name="KullaniciYorumu" cols="30" rows="6" class="bg-gradient-to-b from-gray-100 to-gray-100"></textarea>
                                    </div>
                                    <div class="col-span-2 flex justify-between py-4">
                                        <input type="submit" value="Yorumu Gönder">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="lg:w-1/4 w-full flex-shrink-0">

                @await Component.InvokeAsync("KategoriList")
                <div uk-sticky="offset:100" class="uk-sticky">

                    <h2 class="text-2xl font-semibold mb-3"> Popüler İçerikler </h2>
                    <ul>
                        @foreach (var item in Model.populerIceriklerDtos.OrderByDescending(i => i.OkunmaSayisi).Take(6))
                        {
                            <li>
                                <a asp-controller="Blog" asp-action="yazi" asp-route-Post="@item.UrlBaslik"
                                   class="hover:bg-gray-100 rounded-md p-2 -mx-2 block">
                                    <h3 class="font-medium line-clamp-2"> @item.Baslik</h3>
                                    <div class="flex items-center my-auto text-xs space-x-1.5">
                                        <div>Okunma Sayısı</div>
                                        <div>@item.OkunmaSayisi</div>
                                    </div>
                                </a>
                            </li>
                        }
                    </ul>
                    <br>
                </div>
            </div>
        </div>

    </div>
</div>